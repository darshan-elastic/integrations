---
processors:
  - set:
      field: event.kind
      value: event
  - grok:
      field: remaining_message
      patterns:
        - "Internal %{DATA:network.protocol} giving up on message to %{DATA:email.to.address} with subject %{GREEDYDATA:email.subject}."
        - "%{GREEDYDATA:cisco_esa.log.description}: Unable to send System/Warning %{DATA:event.kind} to %{DATA:email.to.address} with subject \"%{GREEDYDATA:email.subject}\"."
        - "%{WORD:cisco_esa.log.alert_category}: %{GREEDYDATA:cisco_esa.log.description}"
        - "Internal %{DATA:network.protocol} system attempting to send a message to %{DATA:email.to.address} with subject %{GREEDYDATA:email.subject}."
        - "%{GREEDYDATA:cisco_esa.log.message}"
  - lowercase:
      field: network.protocol
      ignore_failure: true
