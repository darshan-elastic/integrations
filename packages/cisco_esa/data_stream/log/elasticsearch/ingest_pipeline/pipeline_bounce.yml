---
processors:
  - set:
      field: event.kind
      value: event
  - grok:
      field: remaining_message
      patterns:
        - "%{WORD:cisco_esa.log.bounce_type}: DCID %{NUMBER:cisco_esa.log.delivery_connection_id} MID %{NUMBER:email.message_id} From:<%{GREEDYDATA:email.from.address}> To:<%{GREEDYDATA:email.to.address}> RID %{NUMBER:cisco_esa.log.recipient_id} - %{DATA:cisco_esa.log.error_code} - %{GREEDYDATA:event.reason} \\(%{GREEDYDATA:cisco_esa.log.response}\\)"
        - "%{WORD:cisco_esa.log.bounce_type}: %{NUMBER:email.message_id}:%{NUMBER:cisco_esa.log.recipient_id} From:<%{GREEDYDATA:email.from.address}> To:<%{GREEDYDATA:email.to.address}>"
        - "%{GREEDYDATA:cisco_esa.log.message}"
