rules:
  - path: /insights/get
    methods: ["POST"]
    responses:
      - status_code: 200
        body: |
          {"Insights":[{"Filters":{"AwsAccountId":[{"Comparison":"string","Value":"string"}],"CompanyName":[{"Comparison":"string","Value":"string"}],"ComplianceStatus":[{"Comparison":"string","Value":"string"}],"Confidence":[{"Eq":20,"Gte":20,"Lte":20}],"CreatedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"Criticality":[{"Eq":20,"Gte":20,"Lte":20}],"Description":[{"Comparison":"string","Value":"string"}],"FindingProviderFieldsConfidence":[{"Eq":20,"Gte":20,"Lte":20}],"FindingProviderFieldsCriticality":[{"Eq":20,"Gte":20,"Lte":20}],"FindingProviderFieldsRelatedFindingsId":[{"Comparison":"string","Value":"string"}],"FindingProviderFieldsRelatedFindingsProductArn":[{"Comparison":"string","Value":"string"}],"FindingProviderFieldsSeverityLabel":[{"Comparison":"string","Value":"string"}],"FindingProviderFieldsSeverityOriginal":[{"Comparison":"string","Value":"string"}],"FindingProviderFieldsTypes":[{"Comparison":"string","Value":"string"}],"FirstObservedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"GeneratorId":[{"Comparison":"string","Value":"string"}],"Id":[{"Comparison":"string","Value":"string"}],"Keyword":[{"Value":"string"}],"LastObservedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"MalwareName":[{"Comparison":"string","Value":"string"}],"MalwarePath":[{"Comparison":"string","Value":"string"}],"MalwareState":[{"Comparison":"string","Value":"string"}],"MalwareType":[{"Comparison":"string","Value":"string"}],"NetworkDestinationDomain":[{"Comparison":"string","Value":"string"}],"NetworkDestinationIpV4":[{"Cidr":"string"}],"NetworkDestinationIpV6":[{"Cidr":"string"}],"NetworkDestinationPort":[{"Eq":20,"Gte":20,"Lte":20}],"NetworkDirection":[{"Comparison":"string","Value":"string"}],"NetworkProtocol":[{"Comparison":"string","Value":"string"}],"NetworkSourceDomain":[{"Comparison":"string","Value":"string"}],"NetworkSourceIpV4":[{"Cidr":"string"}],"NetworkSourceIpV6":[{"Cidr":"string"}],"NetworkSourceMac":[{"Comparison":"string","Value":"string"}],"NetworkSourcePort":[{"Eq":20,"Gte":20,"Lte":20}],"NoteText":[{"Comparison":"string","Value":"string"}],"NoteUpdatedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"NoteUpdatedBy":[{"Comparison":"string","Value":"string"}],"ProcessLaunchedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"ProcessName":[{"Comparison":"string","Value":"string"}],"ProcessParentPid":[{"Eq":20,"Gte":20,"Lte":20}],"ProcessPath":[{"Comparison":"string","Value":"string"}],"ProcessPid":[{"Eq":20,"Gte":20,"Lte":20}],"ProcessTerminatedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"ProductArn":[{"Comparison":"string","Value":"string"}],"ProductFields":[{"Comparison":"string","Key":"string","Value":"string"}],"ProductName":[{"Comparison":"string","Value":"string"}],"RecommendationText":[{"Comparison":"string","Value":"string"}],"RecordState":[{"Comparison":"string","Value":"string"}],"Region":[{"Comparison":"string","Value":"string"}],"RelatedFindingsId":[{"Comparison":"string","Value":"string"}],"RelatedFindingsProductArn":[{"Comparison":"string","Value":"string"}],"ResourceAwsEc2InstanceIamInstanceProfileArn":[{"Comparison":"string","Value":"string"}],"ResourceAwsEc2InstanceImageId":[{"Comparison":"string","Value":"string"}],"ResourceAwsEc2InstanceIpV4Addresses":[{"Cidr":"string"}],"ResourceAwsEc2InstanceIpV6Addresses":[{"Cidr":"string"}],"ResourceAwsEc2InstanceKeyName":[{"Comparison":"string","Value":"string"}],"ResourceAwsEc2InstanceLaunchedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"ResourceAwsEc2InstanceSubnetId":[{"Comparison":"string","Value":"string"}],"ResourceAwsEc2InstanceType":[{"Comparison":"string","Value":"string"}],"ResourceAwsEc2InstanceVpcId":[{"Comparison":"string","Value":"string"}],"ResourceAwsIamAccessKeyCreatedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"ResourceAwsIamAccessKeyPrincipalName":[{"Comparison":"string","Value":"string"}],"ResourceAwsIamAccessKeyStatus":[{"Comparison":"string","Value":"string"}],"ResourceAwsIamAccessKeyUserName":[{"Comparison":"string","Value":"string"}],"ResourceAwsIamUserUserName":[{"Comparison":"string","Value":"string"}],"ResourceAwsS3BucketOwnerId":[{"Comparison":"string","Value":"string"}],"ResourceAwsS3BucketOwnerName":[{"Comparison":"string","Value":"string"}],"ResourceContainerImageId":[{"Comparison":"string","Value":"string"}],"ResourceContainerImageName":[{"Comparison":"string","Value":"string"}],"ResourceContainerLaunchedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"ResourceContainerName":[{"Comparison":"string","Value":"string"}],"ResourceDetailsOther":[{"Comparison":"string","Key":"string","Value":"string"}],"ResourceId":[{"Comparison":"string","Value":"string"}],"ResourcePartition":[{"Comparison":"string","Value":"string"}],"ResourceRegion":[{"Comparison":"string","Value":"string"}],"ResourceTags":[{"Comparison":"string","Key":"string","Value":"string"}],"ResourceType":[{"Comparison":"string","Value":"string"}],"Sample":[{"Value":true}],"SeverityLabel":[{"Comparison":"string","Value":"string"}],"SeverityNormalized":[{"Eq":20,"Gte":20,"Lte":20}],"SeverityProduct":[{"Eq":20,"Gte":20,"Lte":20}],"SourceUrl":[{"Comparison":"string","Value":"string"}],"ThreatIntelIndicatorCategory":[{"Comparison":"string","Value":"string"}],"ThreatIntelIndicatorLastObservedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"ThreatIntelIndicatorSource":[{"Comparison":"string","Value":"string"}],"ThreatIntelIndicatorSourceUrl":[{"Comparison":"string","Value":"string"}],"ThreatIntelIndicatorType":[{"Comparison":"string","Value":"string"}],"ThreatIntelIndicatorValue":[{"Comparison":"string","Value":"string"}],"Title":[{"Comparison":"string","Value":"string"}],"Type":[{"Comparison":"string","Value":"string"}],"UpdatedAt":[{"DateRange":{"Unit":"string","Value":20},"End":"2020-07-10 15:00:00.000","Start":"2020-07-10 15:00:00.000"}],"UserDefinedFields":[{"Comparison":"string","Key":"string","Value":"string"}],"VerificationState":[{"Comparison":"string","Value":"string"}],"WorkflowState":[{"Comparison":"string","Value":"string"}],"WorkflowStatus":[{"Comparison":"string","Value":"string"}]},"GroupByAttribute":"string","InsightArn":"string","Name":"string"}]}
  - path: /findings
    methods: ["POST"]
    responses:
      - status_code: 200
        body: |
          {"Findings":[{"Action":{"ActionType":"PORT_PROBE","PortProbeAction":{"PortProbeDetails":[{"LocalPortDetails":{"Port":80,"PortName":"HTTP"},"LocalIpDetails":{"IpAddressV4":"1.128.0.0"},"RemoteIpDetails":{"Country":{"CountryName":"Example Country"},"City":{"CityName":"Example City"},"GeoLocation":{"Lon":0,"Lat":0},"Organization":{"AsnOrg":"ExampleASO","Org":"ExampleOrg","Isp":"ExampleISP","Asn":64496}}}],"Blocked":false}},"AwsAccountId":"111111111111","CompanyName":"AWS","Compliance":{"RelatedRequirements":["Req1","Req2"],"Status":"PASSED","StatusReasons":[{"ReasonCode":"CLOUDWATCH_ALARMS_NOT_PRESENT","Description":"CloudWatch alarms do not exist in the account"}]},"Confidence":42,"CreatedAt":"2017-03-22T13:22:13.933Z","Criticality":99,"Description":"The version of openssl found on instance i-abcd1234 is known to contain a vulnerability.","FindingProviderFields":{"Confidence":42,"Criticality":99,"RelatedFindings":[{"ProductArn":"arn:aws:securityhub:us-west-2::product/aws/guardduty","Id":"123e4567-e89b-12d3-a456-426655440000"}],"Severity":{"Label":"MEDIUM","Original":"MEDIUM"},"Types":["Software and Configuration Checks/Vulnerabilities/CVE"]},"FirstObservedAt":"2017-03-22T13:22:13.933Z","GeneratorId":"acme-vuln-9ab348","Id":"us-west-2/111111111111/98aebb2207407c87f51e89943f12b1ef","LastObservedAt":"2017-03-23T13:22:13.933Z","Malware":[{"Name":"Stringler","Type":"COIN_MINER","Path":"/usr/sbin/stringler","State":"OBSERVED"}],"Network":{"Direction":"IN","OpenPortRange":{"Begin":443,"End":443},"Protocol":"TCP","SourceIpV4":"1.128.0.0","SourceIpV6":"2a02:cf40::","SourcePort":"42","SourceDomain":"example1.com","SourceMac":"00:0d:83:b1:c0:8e","DestinationIpV4":"1.128.0.0","DestinationIpV6":"2a02:cf40::","DestinationPort":"80","DestinationDomain":"example2.com"},"NetworkPath":[{"ComponentId":"abc-01a234bc56d8901ee","ComponentType":"AWS::EC2::InternetGateway","Egress":{"Destination":{"Address":["1.128.0.0/24"],"PortRanges":[{"Begin":443,"End":443}]},"Protocol":"TCP","Source":{"Address":["175.16.199.1/24"]}},"Ingress":{"Destination":{"Address":["175.16.199.1/24"],"PortRanges":[{"Begin":443,"End":443}]},"Protocol":"TCP","Source":{"Address":["175.16.199.1/24"]}}}],"Note":{"Text":"Don't forget to check under the mat.","UpdatedBy":"jsmith","UpdatedAt":"2018-08-31T00:15:09Z"},"PatchSummary":{"Id":"pb-123456789098","InstalledCount":"100","MissingCount":"100","FailedCount":"0","InstalledOtherCount":"1023","InstalledRejectedCount":"0","InstalledPendingReboot":"0","OperationStartTime":"2018-09-27T23:37:31Z","OperationEndTime":"2018-09-27T23:39:31Z","RebootOption":"RebootIfNeeded","Operation":"Install"},"Process":{"Name":"syslogd","Path":"/usr/sbin/syslogd","Pid":12345,"ParentPid":56789,"LaunchedAt":"2018-09-27T22:37:31Z","TerminatedAt":"2018-09-27T23:37:31Z"},"ProductArn":"arn:aws:securityhub:us-east-1:111111111111:product/111111111111/default","ProductFields":{"generico/secure-pro/Count":"6","Service_Name":"cloudtrail.amazonaws.com","aws/inspector/AssessmentTemplateName":"My daily CVE assessment","aws/inspector/AssessmentTargetName":"My prod env","aws/inspector/RulesPackageName":"Common Vulnerabilities and Exposures"},"ProductName":"Security Hub","RecordState":"ACTIVE","Region":"us-east-1","RelatedFindings":[{"ProductArn":"arn:aws:securityhub:us-west-2::product/aws/guardduty","Id":"123e4567-e89b-12d3-a456-426655440000"},{"ProductArn":"arn:aws:securityhub:us-west-2::product/aws/guardduty","Id":"AcmeNerfHerder-111111111111-x189dx7824"}],"Remediation":{"Recommendation":{"Text":"Run sudo yum update and cross your fingers and toes.","Url":"http://myfp.com/recommendations/dangerous_things_and_how_to_fix_them.html"}},"Resources":[{"Type":"AwsEc2Instance","Id":"i-cafebabe","Partition":"aws","Region":"us-west-2","Tags":{"billingCode":"Lotus-1-2-3","needsPatching":"true"},"Details":{"IamInstanceProfileArn":"arn:aws:iam::123456789012:role/IamInstanceProfileArn","ImageId":"ami-79fd7eee","IpV4Addresses":["175.16.199.1"],"IpV6Addresses":["2a02:cf40::"],"KeyName":"testkey","LaunchedAt":"2018-09-29T01:25:54Z","MetadataOptions":{"HttpEndpoint":"enabled","HttpProtocolIpv6":"enabled","HttpPutResponseHopLimit":1,"HttpTokens":"optional","InstanceMetadataTags":"disabled"},"NetworkInterfaces":[{"NetworkInterfaceId":"eni-e5aa89a3"}],"SubnetId":"PublicSubnet","Type":"i3.xlarge","VirtualizationType":"hvm","VpcId":"TestVPCIpv6"}}],"Sample":true,"SchemaVersion":"2018-10-08","Severity":{"Label":"CRITICAL","Original":"8.3"},"SourceUrl":"http://threatintelweekly.org/backdoors/8888","ThreatIntelIndicators":[{"Type":"IPV4_ADDRESS","Value":"175.16.199.1","Category":"BACKDOOR","LastObservedAt":"2018-09-27T23:37:31Z","Source":"Threat Intel Weekly","SourceUrl":"http://threatintelweekly.org/backdoors/8888"}],"Threats":[{"FilePaths":[{"FileName":"b.txt","FilePath":"/tmp/b.txt","Hash":"sha256","ResourceId":"arn:aws:ec2:us-west-2:123456789012:volume/vol-032f3bdd89aee112f"}],"ItemCount":3,"Name":"Iot.linux.mirai.vwisi","Severity":"HIGH"}],"Title":"EC2.20 Both VPN tunnels for an AWS Site-to-Site VPN connection should be up","Types":["Software and Configuration Checks/Vulnerabilities/CVE"],"UpdatedAt":"2018-08-31T00:15:09Z","UserDefinedFields":{"reviewedByCio":"true","comeBackToLater":"Check this again on Monday"},"VerificationState":"UNKNOWN","Vulnerabilities":[{"Cvss":[{"BaseScore":4.7,"BaseVector":"AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N","Version":"V3"},{"BaseScore":4.7,"BaseVector":"AV:L/AC:M/Au:N/C:C/I:N/A:N","Version":"V2"}],"Id":"CVE-2020-12345","ReferenceUrls":["http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12418","http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17563"],"RelatedVulnerabilities":["CVE-2020-12345"],"Vendor":{"Name":"Alas","Url":"https://alas.aws.amazon.com/ALAS-2020-1337.html","VendorCreatedAt":"2020-01-16T00:01:43Z","VendorSeverity":"Medium","VendorUpdatedAt":"2020-01-16T00:01:43Z"},"VulnerablePackages":[{"Architecture":"x86_64","Epoch":"1","Name":"openssl","Release":"16.amzn2.0.3","Version":"1.0.2k"}]}],"Workflow":{"Status":"NEW"},"WorkflowState":"NEW"}]}
